_G.AutoFarm = true

spawn(function()
    while _G.AutoFarm do
        task.wait()
        pcall(function()
            for _, enemy in pairs(game:GetService("Workspace").Enemies:GetChildren()) do
                if enemy:FindFirstChild("Humanoid") and enemy.Humanoid.Health > 0 then
                    repeat
                        task.wait()
                        -- Stand on enemy's head (5 units above)
                        game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = enemy.HumanoidRootPart.CFrame * CFrame.new(0, 5, 0) * CFrame.Angles(math.rad(-90), 0, 0)
                        
                        -- Auto Attack execution
                        game:GetService("VirtualUser"):CaptureController()
                        game:GetService("VirtualUser"):Button1Down(Vector2.new(0,1e3), game.Workspace.CurrentCamera.CFrame)
                    until not _G.AutoFarm or enemy.Humanoid.Health <= 0
                end
            end
        end)
    end
end)
